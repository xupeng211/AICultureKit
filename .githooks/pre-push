#!/bin/sh

# AICultureKit 简化版推送前检查钩子
# 只做快速语法检查，其他检查在 GitHub Actions 中完成

# 颜色定义
RED='\033[0;31m'
GREEN='\033[0;32m'
BLUE='\033[0;34m'
NC='\033[0m'

echo -e "${BLUE}🚀 Running quick syntax check before push...${NC}"

# 检查是否有未提交的更改
if ! git diff-index --quiet HEAD --; then
    echo -e "${RED}❌ 检测到未提交的更改，请先提交所有更改${NC}"
    exit 1
fi

# 运行快速语法检查 (compile-only)
echo -e "${BLUE}🧪 Running compile-only syntax check...${NC}"
if ! python -m compileall aiculture; then
    echo -e "${RED}❌ 语法检查失败，推送被阻止${NC}"
    echo -e "${BLUE}💡 请修复语法错误后再推送${NC}"
    exit 1
fi

echo -e "${GREEN}✅ 语法检查通过，允许推送${NC}"
echo -e "${BLUE}💡 完整的测试和质量检查将在 GitHub Actions 中执行${NC}"
exit 0
